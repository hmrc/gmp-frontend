@*
 * Copyright 2022 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.govukfrontend.views.html.components._
@import uk.gov.hmrc.govukfrontend.views.html.components.implicits._
@import config.ApplicationConfig
@import views.html.helpers._
@import models.CalculationType
@import views.ViewHelpers
@import uk.gov.hmrc.hmrcfrontend.views.Implicits.RichErrorSummary

@this(gmpMain: gmp_main, viewHelpers: ViewHelpers, govukRadios : GovukRadios, govukButton : GovukButton, govukErrorSummary : GovukErrorSummary)

@(revaluationRateForm: Form[models.RevaluationRate], session: GmpSession)(implicit request: Request[_], messages: Messages, ac:ApplicationConfig)

@heading = {
        @{session.scenario match {
        case CalculationType.PAYABLE_AGE | CalculationType.SPA | CalculationType.SURVIVOR => Messages("gmp.revaluation_rate.header")
        case CalculationType.REVALUATION => {
        session.revaluationDate match {
        case Some(rd) if(!rd.isOnOrAfter06042016) => Messages("gmp.revaluation_rate.header")
        case _ => Messages("gmp.revaluation_rate.header")
        }
        }
        case _ => Messages("gmp.revaluation_rate.header")
        }}
}
@gmpMain(title = heading + " - " + Messages("service.title") + " - " + Messages("gov.uk")) {

        @includes.back_link(Messages("gmp.revaluation_rate.header"))


          @viewHelpers.form(action = routes.RevaluationRateController.post) {
            @if(revaluationRateForm.errors.nonEmpty){
                @govukErrorSummary(ErrorSummary().withFormErrorsAsText(revaluationRateForm))
            }

            <div class="form-group @if(revaluationRateForm.hasErrors) {form-field--error}" id="rateType">

              @govukRadios(Radios(
                  fieldset = Some(Fieldset(
                      legend = Some(Legend(
                          content = Text(Messages("gmp.revaluation_rate.header")),
                          classes = "govuk-fieldset__legend--l",
                          isPageHeading = true
                      ))
                  )),
                  idPrefix = Some("rateType"),
                  name = "rateType",
                  items = session.leaving.leaving match{
                            case Leaving.YES_AFTER | Leaving.NO => Seq(
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.fixed")), value = Some("fixed"), id = Some("fixed"), attributes=Map("data-journey-click" -> "radio - select:Guaranteed Minimum Pension:fixed")),
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.rate_held_by_hmrc")), value = Some("hmrc"), id = Some("hmrc")),
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.s148")), value = Some("s148"), id = Some("s148")))
                            case _ => Seq(
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.fixed")), value = Some("fixed"), id = Some("fixed")),
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.rate_held_by_hmrc")), value = Some("hmrc"), id = Some("hmrc")),
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.limited")), value = Some("limited"), id = Some("limited")),
                                RadioItem( content = Text(Messages("gmp.revaluation_rate.s148")), value = Some("s148"), id = Some("s148")))}

              ).withFormField(revaluationRateForm("rateType")))


            </div>
          <div>
              @govukButton(Button(
                content = Text(Messages("gmp.continue.button")),
                inputType = Some("submit")
              ))

          </div>

          }
}
